<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Noah Kaye">
<meta name="dcterms.date" content="2023-04-27">

<title>Homework 3: Probability, Statistics and Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="hw-03_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw-03_files/libs/quarto-html/quarto.js"></script>
<script src="hw-03_files/libs/quarto-html/popper.min.js"></script>
<script src="hw-03_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw-03_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw-03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw-03_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw-03_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw-03_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw-03_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Homework 3: Probability, Statistics and Machine Learning</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Spring 2023 MATH/COSC 3570 Introduction to Data Science by Dr.&nbsp;Cheng-Han Yu</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><strong>Noah Kaye</strong> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 27, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<ul>
<li><strong>Note: For any simulation or random sampling, set the random seed at your student ID number, for example <code>set.seed(6145678)</code>.</strong></li>
</ul>
<section id="probability-and-statistics" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Probability and Statistics</h1>
<section id="monte-carlo-simulation" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="monte-carlo-simulation"><span class="header-section-number">1.1</span> Monte Carlo Simulation</h2>
<ol type="1">
<li>Milwaukee Bucks and Golden State Warriors are playing NBA Finals (I hope!). The first to win four games wins the series. The Bucks are a better team and have a 60% chance of winning each game. If the Bucks lose the first game, calculate the probability that they win the NBA championship? <strong>[Hint]</strong>: You can use binomial distribution, and given the first game loss, the probability <span class="math inline">\(P(\text{Bucks wins the series})\)</span> is</li>
</ol>
<p><span class="math display">\[P(\text{Bucks wins 4 in a row}) + P(\text{Bucks wins 4 in 5 games}) + P(\text{Bucks wins 4 in 6 games})\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">4</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">prob=</span>.<span class="dv">6</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">prob=</span>.<span class="dv">6</span>)<span class="sc">*</span><span class="fl">0.6</span> <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">prob=</span>.<span class="dv">6</span>)<span class="sc">*</span><span class="fl">0.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.54432</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Confirm the results of the previous question with a Monte Carlo simulation.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"bucks"</span>, <span class="st">"bucks"</span>, <span class="st">"bucks"</span>, <span class="st">"bucks"</span>, <span class="st">"warriors"</span>, <span class="st">"warriors"</span>, <span class="st">"warriors"</span>, <span class="st">"warriors"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">006220587</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>mc4 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#bucks_wins_4 &lt;- sample(c(0, 1), 4, prob = c(0.4, 0.6), replace = TRUE)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    bucks_wins_4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    bucks_wins_4 <span class="sc">==</span> <span class="dv">4</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>mc4_result <span class="ot">=</span> <span class="fu">mean</span>(mc4)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mc4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1253</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span><span class="sc">^</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1296</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mc5 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    bucks_wins_5 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    bucks_wins_5 <span class="sc">==</span> <span class="dv">3</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mc5_result <span class="ot">=</span> <span class="fu">mean</span>(mc5)<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>mc5_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.20616</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">prob=</span>.<span class="dv">6</span>)<span class="sc">*</span><span class="fl">0.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.20736</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mc6 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    bucks_wins_6 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    bucks_wins_6 <span class="sc">==</span> <span class="dv">3</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>mc6_result <span class="ot">=</span> <span class="fu">mean</span>(mc6)<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>mc6_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.20814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">*</span><span class="fl">0.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.20736</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mc4_result <span class="sc">+</span> mc5_result <span class="sc">+</span> mc6_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5396</code></pre>
</div>
</div>
</section>
<section id="central-limit-theorem" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="central-limit-theorem"><span class="header-section-number">1.2</span> Central Limit Theorem</h2>
<p>Suppose random variables <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> are independent and follow Chi-squared distribution with degrees of freedom 1, <span class="math inline">\(\chi^2_{df=1}\)</span>.</p>
<ol type="1">
<li>Use <code>dchisq()</code> to plot <span class="math inline">\(\chi^2_{df=1}\)</span> distribution. Consider <span class="math inline">\(x\in (0, 5)\)</span>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">dchisq</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>), <span class="dv">1</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li>Consider three sample sizes <span class="math inline">\(n = 2, 8, 100\)</span>, and set the sample size of the sample mean <span class="math inline">\(\overline{X}_n\)</span> be <span class="math inline">\(1000\)</span>. Show the sampling distribution of <span class="math inline">\(\overline{X}_n\)</span>, i.e., the collection <span class="math inline">\(\{\overline{X}_n^{(m)}\}_{m=1}^{1000}\)</span>, looks more and more like Gaussian as <span class="math inline">\(n\)</span> increases by making histograms of <span class="math inline">\(\overline{X}_n\)</span> samples with <span class="math inline">\(n = 2, 8, 100\)</span>. The procedure is the following:</li>
</ol>
<p>For each <span class="math inline">\(n = 2, 8, 100\)</span>,</p>
<ol type="i">
<li>Draw <span class="math inline">\(n\)</span> values <span class="math inline">\(x_1, x_2, \dots, x_n\)</span> using <code>rchisq(n, df = 1)</code>.</li>
<li>Compute the mean of the <span class="math inline">\(n\)</span> values, which is <span class="math inline">\(\overline{x}_n\)</span>.</li>
<li>Repeat i. and ii. 1000 times to obtain 1000 <span class="math inline">\(\overline{x}_n\)</span>s.</li>
<li>Plot the histogram of these 1000 <span class="math inline">\(\overline{x}_n\)</span>s.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">006220587</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>chi2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mean</span>(<span class="fu">rchisq</span>(<span class="dv">2</span>, <span class="at">df =</span> <span class="dv">1</span>)))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>chi2 <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#8</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>chi8 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mean</span>(<span class="fu">rchisq</span>(<span class="dv">8</span>, <span class="at">df =</span> <span class="dv">1</span>)))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>chi8 <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#100</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>chi100 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mean</span>(<span class="fu">rchisq</span>(<span class="dv">100</span>, <span class="at">df =</span> <span class="dv">1</span>)))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>chi100 <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="machine-learning" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Machine Learning</h1>
<section id="linear-regression" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">2.1</span> Linear Regression</h2>
<p>A pharmaceutical firm would like to obtain information on the relationship between the dose level and potency of a drug product. To do this, each of 15 test tubes is inoculated with a virus culture and incubated for 5 days at 30°C. Three test tubes are randomly assigned to each of the five different dose levels to be investigated (2, 4, 8, 16, and 32 mg). Each tube is injected with only one dose level, and the response of interest is obtained.</p>
<ol type="1">
<li>Import <code>dose.csv</code> in the <code>/data</code> folder into your R session. The data set is not tidy. Use <code>pivot_longer()</code> to make it tidy as the shown tibble below. Call the tidy data set <code>dose_tidy</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dose <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./data/dose.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): dose_level, tube_1, tube_2, tube_3

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dose</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  dose_level tube_1 tube_2 tube_3
       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1          2      5      7      3
2          4     10     12     14
3          8     15     17     18
4         16     20     21     19
5         32     23     24     29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dose_tidy <span class="ot">&lt;-</span> dose <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> tube_1<span class="sc">:</span>tube_3, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">names_to =</span> <span class="st">"tube"</span>, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">values_to =</span> <span class="st">"response"</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>dose_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 3
   dose_level tube   response
        &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1          2 tube_1        5
 2          2 tube_2        7
 3          2 tube_3        3
 4          4 tube_1       10
 5          4 tube_2       12
 6          4 tube_3       14
 7          8 tube_1       15
 8          8 tube_2       17
 9          8 tube_3       18
10         16 tube_1       20
11         16 tube_2       21
12         16 tube_3       19
13         32 tube_1       23
14         32 tube_2       24
15         32 tube_3       29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 15 × 3</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    dose_level tube  response</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">##         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  1          2 tube1        5</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  2          2 tube2        7</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  3          2 tube3        3</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  4          4 tube1       10</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  5          4 tube2       12</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  6          4 tube3       14</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  7          8 tube1       15</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  8          8 tube2       17</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  9          8 tube3       18</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 10         16 tube1       20</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 11         16 tube2       21</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 12         16 tube3       19</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 13         32 tube1       23</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 14         32 tube2       24</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 15         32 tube3       29</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Fit a simple linear regression with the predictor <span class="math inline">\(\texttt{dose level}\)</span> for <code>response</code>. Print the fitted result.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>doseLin1 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(response <span class="sc">~</span> dose_level, <span class="at">data =</span> dose_tidy)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>doseLin1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:
stats::lm(formula = response ~ dose_level, data = data)

Coefficients:
(Intercept)   dose_level  
     8.6667       0.5753  </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>With (2), plot the data with a <span class="math inline">\(95\%\)</span> confidence interval for the mean response.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>confLin <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">predict</span>(doseLin1<span class="sc">$</span>fit,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">level =</span> <span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as.tibble()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` instead.
ℹ The signature and semantics have changed, see `?as_tibble`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(doseLin1$fit, interval = "prediction", level = 0.95): predictions on current data refer to _future_ responses</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>doseLin1<span class="sc">$</span>fit <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose_level, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>lwr),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>upr),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>Fit a simple linear regression model with the predictor <span class="math inline">\(\texttt{ln(dose level)}\)</span> for <code>response</code>, where <span class="math inline">\(\ln = \log_e\)</span>. Print the fitted result.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dose_tidy <span class="ot">&lt;-</span> dose_tidy <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ln_dose_level =</span> <span class="fu">log</span>(dose_level))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>doseLin2 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(response <span class="sc">~</span> ln_dose_level, <span class="at">data =</span> dose_tidy)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>doseLin2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:
stats::lm(formula = response ~ ln_dose_level, data = data)

Coefficients:
  (Intercept)  ln_dose_level  
        1.200          7.021  </code></pre>
</div>
</div>
<ol start="5" type="1">
<li>With (4), plot the data <span class="math inline">\((\ln(\text{dose level})_i, y_i)\)</span> with a <span class="math inline">\(95\%\)</span> confidence interval for the mean response.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>confLin <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">predict</span>(doseLin2<span class="sc">$</span>fit,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">level =</span> <span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(doseLin2$fit, interval = "prediction", level = 0.95): predictions on current data refer to _future_ responses</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>doseLin2<span class="sc">$</span>fit <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ln_dose_level, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ln_dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>lwr),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ln_dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>upr),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="6" type="1">
<li>Draw residual plots of Model in (2) and (4). According to the plots, which model you think is better?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(doseLin1<span class="sc">$</span>fit, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">las =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(doseLin2<span class="sc">$</span>fit, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">las =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-03_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There seems to be less of a pattern in the regression plot using ln_dose_level (the second one), whereas the first one seems to be overfitted, so the model used in the second regression plot is the better model.</p>
<ol start="7" type="1">
<li>Import <code>dose_tidy.csv</code> and redo (2) using <strong>Python</strong>. Show the slope and intercept.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>dose_tidy <span class="op">=</span> pd.read_csv(<span class="st">'./data/dose_tidy.csv'</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array(dose_tidy[<span class="st">'dose_level'</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(dose_tidy[<span class="st">'response'</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> LinearRegression().fit(x, y)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>reg.coef_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[0.57526882]])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>reg.intercept_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([8.66666667])</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Use <strong>Python</strong> to predict the response value when the dose level is 10, 20, and 30.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>new_input <span class="op">=</span> np.arange(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> reg.predict(new_input)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[14.41935484]])</code></pre>
</div>
</div>
</section>
<section id="logistic-regression" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">2.2</span> Logistic Regression</h2>
<ol type="1">
<li>Import <code>body.csv</code> in the <code>/data</code> folder. Split the data into a training set and a test set. Set the random seed at your student ID number. Use 80:20 rule.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">006220587</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  body <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./data/body.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 300 Columns: 15
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (15): AGE, GENDER, PULSE, SYSTOLIC, DIASTOLIC, HDL, LDL, WHITE, RED, PLA...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> body, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>df_trn <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(df_split)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_trn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 240  15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df_tst <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(df_split)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_tst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60 15</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Fit a logistic regression with the predictor <code>HEIGHT</code> using the training sample data. Find the probability that the subject is male given <code>HEIGHT = 165</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>logis_mdl_ht <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"glm"</span>) </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>df_trn<span class="sc">$</span>GENDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_trn<span class="sc">$</span>GENDER)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>logis_fit_ht <span class="ot">&lt;-</span> logis_mdl_ht <span class="sc">|&gt;</span> </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(GENDER <span class="sc">~</span> HEIGHT, </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df_trn, </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logis_fit_ht<span class="sc">$</span>fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">HEIGHT =</span> <span class="dv">165</span>), <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.3303152 </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Fit a logistic regression with the predictor <code>BMI</code> using the training sample data. Find the probability that the subject is male given <code>BMI = 25</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>logis_mdl_bmi <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"glm"</span>) </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>logis_fit_bmi <span class="ot">&lt;-</span> logis_mdl_bmi <span class="sc">|&gt;</span> </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(GENDER <span class="sc">~</span> BMI, </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df_trn, </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logis_fit_bmi<span class="sc">$</span>fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">BMI =</span> <span class="dv">165</span>), <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1 
0.002603268 </code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Do the classification on the test set for the model (2) and (3), and compute the test accuracy rate. Which model gives us higher accuracy rate?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># height</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>pred_ht <span class="ot">&lt;-</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(logis_fit_ht, df_tst))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pred_ht <span class="sc">==</span> df_tst<span class="sc">$</span>GENDER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bmi</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>pred_bmi <span class="ot">&lt;-</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(logis_fit_bmi, df_tst))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pred_bmi <span class="sc">==</span> df_tst<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>The better test accuracy rate is from the regression fitted to HEIGHT. It is around 85% while the test accuracy rate is 0% for BMI</p>
<ol start="5" type="1">
<li>Use <strong>Python</strong> to split the <code>body</code> data into a training set and a test set.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">## code</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>body <span class="op">=</span> pd.read_csv(<span class="st">'./data/body.csv'</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>body[<span class="st">'GENDER'</span>] <span class="op">=</span> body[<span class="st">'GENDER'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> body[[<span class="st">'HEIGHT'</span>]]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> body[[<span class="st">'GENDER'</span>]]</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HEIGHT
0     172.0
1     186.0
2     154.4
3     160.5
4     179.0
..      ...
295   162.7
296   146.7
297   181.0
298   162.2
299   165.4

[300 rows x 1 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    GENDER
0        0
1        1
2        0
3        1
4        1
..     ...
295      1
296      0
297      1
298      0
299      1

[300 rows x 1 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>X_trn, X_tst, y_trn, y_tst <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">6220587</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>X_trn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HEIGHT
26    169.3
257   181.1
216   164.4
18    178.8
256   178.2
..      ...
37    163.6
269   161.9
168   156.6
24    149.0
277   171.1

[240 rows x 1 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>y_trn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    GENDER
26       1
257      1
216      0
18       0
256      1
..     ...
37       0
269      0
168      0
24       0
277      0

[240 rows x 1 columns]</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Use <strong>Python</strong> to fit a logistic regression with the predictor <code>BMI</code> using the training sample data. Find the probability that the subject is male given <code>BMI = 25</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array(X_trn[<span class="st">'HEIGHT'</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="co">## 2d array with one column</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[169.3],
       [181.1],
       [164.4],
       [178.8],
       [178.2],
       [181.1],
       [180.4],
       [174.4],
       [165.2],
       [156.3],
       [172. ],
       [175.1],
       [180.5],
       [160.5],
       [183.6],
       [159.9],
       [175.9],
       [166.1],
       [180. ],
       [188.4],
       [170. ],
       [162.6],
       [170.7],
       [169.7],
       [148.7],
       [167.9],
       [173.5],
       [162. ],
       [165.8],
       [167.6],
       [166.6],
       [166.4],
       [146.7],
       [151.6],
       [162.5],
       [173.2],
       [177.1],
       [156.5],
       [176.7],
       [171.9],
       [154.6],
       [166.7],
       [176.8],
       [175.5],
       [165.7],
       [163.1],
       [162.4],
       [172.5],
       [166.2],
       [159.4],
       [173.6],
       [190.3],
       [155. ],
       [161.6],
       [155.5],
       [157.3],
       [170.9],
       [174.8],
       [173.8],
       [186.3],
       [164.7],
       [186. ],
       [171.5],
       [155.1],
       [174.9],
       [164. ],
       [175.7],
       [178.4],
       [179.8],
       [166.9],
       [165.6],
       [164.7],
       [155.4],
       [162.8],
       [183.6],
       [169.1],
       [159.5],
       [155. ],
       [168.9],
       [168.5],
       [180.4],
       [158.4],
       [156.5],
       [160.3],
       [153.2],
       [156.8],
       [162.2],
       [164.1],
       [157.6],
       [180.1],
       [144.2],
       [169.7],
       [160. ],
       [152.4],
       [180.3],
       [169.1],
       [161.9],
       [189.7],
       [172.6],
       [181.4],
       [159. ],
       [183.1],
       [176.3],
       [174.7],
       [187.2],
       [168.5],
       [166.6],
       [170.4],
       [155.6],
       [174.6],
       [157.4],
       [158.4],
       [161.2],
       [169.1],
       [178.7],
       [161.5],
       [166.9],
       [169.1],
       [171.4],
       [157.8],
       [181.1],
       [149.5],
       [177.2],
       [179.1],
       [165.3],
       [172.2],
       [178.6],
       [167.1],
       [178.7],
       [162.5],
       [179. ],
       [178.6],
       [171.1],
       [169.3],
       [172.6],
       [155.6],
       [171.7],
       [177.5],
       [154.4],
       [169.8],
       [168.6],
       [164.5],
       [155. ],
       [162.9],
       [171.5],
       [162.9],
       [161.4],
       [162.9],
       [169.1],
       [160.3],
       [165.4],
       [162.7],
       [147.9],
       [193.3],
       [163.3],
       [181.7],
       [174.4],
       [184.3],
       [171.9],
       [170. ],
       [176.6],
       [166.1],
       [162.2],
       [185.1],
       [174.3],
       [162.8],
       [159.4],
       [167. ],
       [170.5],
       [168.2],
       [170.5],
       [160. ],
       [158.4],
       [181.9],
       [169.3],
       [170.1],
       [167.5],
       [172.9],
       [155.6],
       [182. ],
       [166.4],
       [173.7],
       [183.7],
       [166.3],
       [160.6],
       [185.7],
       [167.1],
       [162.2],
       [170.6],
       [164.6],
       [169.8],
       [155.6],
       [164. ],
       [166.1],
       [183.5],
       [153.3],
       [162.5],
       [167.5],
       [169. ],
       [167.7],
       [172.1],
       [165.4],
       [166.9],
       [180.8],
       [154.9],
       [167.7],
       [157.5],
       [160.1],
       [163.1],
       [165.6],
       [160.2],
       [159.5],
       [154.8],
       [183. ],
       [163.3],
       [170.9],
       [155.7],
       [185.1],
       [174.4],
       [182.9],
       [174.4],
       [170.4],
       [179.4],
       [178.7],
       [182.8],
       [150.6],
       [177.5],
       [163. ],
       [165.4],
       [181. ],
       [160.6],
       [167.6],
       [154.1],
       [170. ],
       [152. ],
       [163.6],
       [161.9],
       [156.6],
       [149. ],
       [171.1]])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(y_trn[<span class="st">'GENDER'</span>]) <span class="co">## 1d array</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0,
       1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1,
       1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0,
       1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0,
       0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1,
       0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1,
       1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1,
       0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1,
       1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1,
       1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1,
       1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LogisticRegression().fit(x, y)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> pd.DataFrame({<span class="st">'BMI'</span>: [<span class="dv">25</span>]})</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>prob_male <span class="op">=</span> clf.predict(new_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/cloud/project/myenv/lib/python3.8/site-packages/sklearn/base.py:432: UserWarning: X has feature names, but LogisticRegression was fitted without feature names
  warnings.warn(</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prob_male)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0]</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Use <strong>Python</strong> to do the classification on the test set. Compute the test accuracy rate.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> clf.predict(X_tst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/cloud/project/myenv/lib/python3.8/site-packages/sklearn/base.py:432: UserWarning: X has feature names, but LogisticRegression was fitted without feature names
  warnings.warn(</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>confusion_matrix(y_tst, y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[21, 11],
       [ 4, 24]])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>y_tst_arr <span class="op">=</span> np.array(y_tst[<span class="st">'GENDER'</span>])</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#y_tst = y_tst[:, 1]</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>y_tst_arr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1,
       0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0,
       1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>y_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1,
       0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0,
       1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>np.mean(y_tst_arr <span class="op">==</span> y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.75</code></pre>
</div>
</div>
</section>
<section id="k-nearest-neighbors-knn" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="k-nearest-neighbors-knn"><span class="header-section-number">2.3</span> K-Nearest Neighbors (KNN)</h2>
<ol type="1">
<li>Fit the KNN with <span class="math inline">\(K=1\)</span> and <span class="math inline">\(10\)</span> using <code>BMI</code> on the training data and do the classification on the same test set used in logistic regression. Obtain the confusion matrix for each <span class="math inline">\(K\)</span>. Which <span class="math inline">\(K\)</span> performs better? Why?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>(knn_recipe <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(GENDER <span class="sc">~</span> HEIGHT, <span class="at">data =</span> df_trn) <span class="sc">|&gt;</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor          1

Operations:

Centering and scaling for all_predictors()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(knn_mdl1 <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">nearest_neighbor</span>(<span class="at">neighbors =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"kknn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-Nearest Neighbor Model Specification (classification)

Main Arguments:
  neighbors = 1

Computational engine: kknn </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>(knn_mdl10 <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">nearest_neighbor</span>(<span class="at">neighbors =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"kknn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-Nearest Neighbor Model Specification (classification)

Main Arguments:
  neighbors = 10

Computational engine: kknn </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>(knn_fit1 <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(knn_recipe) <span class="sc">|&gt;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(knn_mdl1) <span class="sc">|&gt;</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(<span class="at">data =</span> df_trn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: nearest_neighbor()

── Preprocessor ────────────────────────────────────────────────────────────────
1 Recipe Step

• step_normalize()

── Model ───────────────────────────────────────────────────────────────────────

Call:
kknn::train.kknn(formula = ..y ~ ., data = data, ks = min_rows(1,     data, 5))

Type of response variable: nominal
Minimal misclassification: 0.2291667
Best kernel: optimal
Best k: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>(knn_fit10 <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(knn_recipe) <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(knn_mdl10) <span class="sc">|&gt;</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(<span class="at">data =</span> df_trn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: nearest_neighbor()

── Preprocessor ────────────────────────────────────────────────────────────────
1 Recipe Step

• step_normalize()

── Model ───────────────────────────────────────────────────────────────────────

Call:
kknn::train.kknn(formula = ..y ~ ., data = data, ks = min_rows(10,     data, 5))

Type of response variable: nominal
Minimal misclassification: 0.2
Best kernel: optimal
Best k: 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>knn_pred1 <span class="ot">&lt;-</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(knn_fit1, df_tst))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Confusion matrix</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(knn_pred1, df_tst<span class="sc">$</span>GENDER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         
knn_pred1  0  1
        0 17  5
        1  7 31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(knn_pred1 <span class="sc">==</span> df_tst<span class="sc">$</span>GENDER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>knn_pred10 <span class="ot">&lt;-</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(knn_fit10, df_tst))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Confusion matrix</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(knn_pred10, df_tst<span class="sc">$</span>GENDER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
knn_pred10  0  1
         0 19  9
         1  5 27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(knn_pred10 <span class="sc">==</span> df_tst<span class="sc">$</span>GENDER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7666667</code></pre>
</div>
</div>
<p>The test accuracy rate is better for k=1 than k=10, meaning that k=1 performs better because a higher percentage of correct predictions were made with k=1</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb107" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Homework 3: Probability, Statistics and Machine Learning"</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Spring 2023 MATH/COSC 3570 Introduction to Data Science by Dr. Cheng-Han Yu"</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "**Noah Kaye**"</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="an">from:</span><span class="co"> markdown+emoji</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="co">  source</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a><span class="do">## !!!DO NOT MAKE ANY CHANGE OF THIS CODE CHUNK!!!##</span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################</span></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Package names</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"knitr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"ggrepel"</span>, </span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>              <span class="st">"tidyverse"</span>, <span class="st">"formatR"</span>, <span class="st">"dslabs"</span>, <span class="st">"janitor"</span>, </span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ggthemes"</span>, <span class="st">"plotly"</span>, <span class="st">"tidymodels"</span>, <span class="st">"kknn"</span>)</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Install packages not yet installed</span></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>installed_packages <span class="ot">&lt;-</span> packages <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(installed_packages <span class="sc">==</span> <span class="cn">FALSE</span>)) {</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(packages[<span class="sc">!</span>installed_packages])</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages loading</span></span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(packages, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Note: For any simulation or random sampling, set the random seed at your student ID number, for example `set.seed(6145678)`.**</span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a><span class="fu"># Probability and Statistics</span></span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Monte Carlo Simulation</span></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Milwaukee Bucks and Golden State Warriors are playing NBA Finals (I hope!). The first to win four games wins the series. The Bucks are a better team and have a 60% chance of winning each game. If the Bucks lose the first game, calculate the probability that they win the NBA championship? **[Hint]**: You can use binomial distribution, and given the first game loss, the probability $P(\text{Bucks wins the series})$ is</span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a>$$P(\text{Bucks wins 4 in a row}) + P(\text{Bucks wins 4 in 5 games}) + P(\text{Bucks wins 4 in 6 games})$$</span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-56"><a href="#cb107-56" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">4</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">prob=</span>.<span class="dv">6</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">prob=</span>.<span class="dv">6</span>)<span class="sc">*</span><span class="fl">0.6</span> <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">prob=</span>.<span class="dv">6</span>)<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb107-57"><a href="#cb107-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-58"><a href="#cb107-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-59"><a href="#cb107-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-60"><a href="#cb107-60" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Confirm the results of the previous question with a Monte Carlo simulation.</span>
<span id="cb107-61"><a href="#cb107-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-64"><a href="#cb107-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-65"><a href="#cb107-65" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-66"><a href="#cb107-66" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"bucks"</span>, <span class="st">"bucks"</span>, <span class="st">"bucks"</span>, <span class="st">"bucks"</span>, <span class="st">"warriors"</span>, <span class="st">"warriors"</span>, <span class="st">"warriors"</span>, <span class="st">"warriors"</span>)</span>
<span id="cb107-67"><a href="#cb107-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-68"><a href="#cb107-68" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">006220587</span>)</span>
<span id="cb107-69"><a href="#cb107-69" aria-hidden="true" tabindex="-1"></a>mc4 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb107-70"><a href="#cb107-70" aria-hidden="true" tabindex="-1"></a>    <span class="co">#bucks_wins_4 &lt;- sample(c(0, 1), 4, prob = c(0.4, 0.6), replace = TRUE)</span></span>
<span id="cb107-71"><a href="#cb107-71" aria-hidden="true" tabindex="-1"></a>    bucks_wins_4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb107-72"><a href="#cb107-72" aria-hidden="true" tabindex="-1"></a>    bucks_wins_4 <span class="sc">==</span> <span class="dv">4</span></span>
<span id="cb107-73"><a href="#cb107-73" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb107-74"><a href="#cb107-74" aria-hidden="true" tabindex="-1"></a>mc4_result <span class="ot">=</span> <span class="fu">mean</span>(mc4)</span>
<span id="cb107-75"><a href="#cb107-75" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mc4)</span>
<span id="cb107-76"><a href="#cb107-76" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb107-77"><a href="#cb107-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-78"><a href="#cb107-78" aria-hidden="true" tabindex="-1"></a>mc5 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb107-79"><a href="#cb107-79" aria-hidden="true" tabindex="-1"></a>    bucks_wins_5 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb107-80"><a href="#cb107-80" aria-hidden="true" tabindex="-1"></a>    bucks_wins_5 <span class="sc">==</span> <span class="dv">3</span></span>
<span id="cb107-81"><a href="#cb107-81" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb107-82"><a href="#cb107-82" aria-hidden="true" tabindex="-1"></a>mc5_result <span class="ot">=</span> <span class="fu">mean</span>(mc5)<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb107-83"><a href="#cb107-83" aria-hidden="true" tabindex="-1"></a>mc5_result</span>
<span id="cb107-84"><a href="#cb107-84" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">prob=</span>.<span class="dv">6</span>)<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb107-85"><a href="#cb107-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-86"><a href="#cb107-86" aria-hidden="true" tabindex="-1"></a>mc6 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb107-87"><a href="#cb107-87" aria-hidden="true" tabindex="-1"></a>    bucks_wins_6 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span>
<span id="cb107-88"><a href="#cb107-88" aria-hidden="true" tabindex="-1"></a>    bucks_wins_6 <span class="sc">==</span> <span class="dv">3</span></span>
<span id="cb107-89"><a href="#cb107-89" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb107-90"><a href="#cb107-90" aria-hidden="true" tabindex="-1"></a>mc6_result <span class="ot">=</span> <span class="fu">mean</span>(mc6)<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb107-91"><a href="#cb107-91" aria-hidden="true" tabindex="-1"></a>mc6_result</span>
<span id="cb107-92"><a href="#cb107-92" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">*</span><span class="fl">0.6</span></span>
<span id="cb107-93"><a href="#cb107-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-94"><a href="#cb107-94" aria-hidden="true" tabindex="-1"></a>mc4_result <span class="sc">+</span> mc5_result <span class="sc">+</span> mc6_result</span>
<span id="cb107-95"><a href="#cb107-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-96"><a href="#cb107-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-97"><a href="#cb107-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-98"><a href="#cb107-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-99"><a href="#cb107-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Central Limit Theorem</span></span>
<span id="cb107-100"><a href="#cb107-100" aria-hidden="true" tabindex="-1"></a>Suppose random variables $X_1, X_2, \dots, X_n$ are independent and follow Chi-squared distribution with degrees of freedom 1, $\chi^2_{df=1}$.</span>
<span id="cb107-101"><a href="#cb107-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-102"><a href="#cb107-102" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use <span class="in">`dchisq()`</span> to plot $\chi^2_{df=1}$ distribution. Consider $x\in (0, 5)$.</span>
<span id="cb107-103"><a href="#cb107-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-106"><a href="#cb107-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-107"><a href="#cb107-107" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-108"><a href="#cb107-108" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb107-109"><a href="#cb107-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb107-110"><a href="#cb107-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">dchisq</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>), <span class="dv">1</span>)</span>
<span id="cb107-111"><a href="#cb107-111" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb107-112"><a href="#cb107-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-113"><a href="#cb107-113" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb107-114"><a href="#cb107-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb107-115"><a href="#cb107-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-116"><a href="#cb107-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-117"><a href="#cb107-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-118"><a href="#cb107-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-119"><a href="#cb107-119" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Consider three sample sizes $n = 2, 8, 100$, and set the sample size of the sample mean $\overline{X}_n$ be $1000$. Show the sampling distribution of $\overline{X}_n$, i.e., the collection $\{\overline{X}_n^{(m)}\}_{m=1}^{1000}$, looks more and more like Gaussian as $n$ increases by making histograms of $\overline{X}_n$ samples with $n = 2, 8, 100$. The procedure is the following:</span>
<span id="cb107-120"><a href="#cb107-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-121"><a href="#cb107-121" aria-hidden="true" tabindex="-1"></a>For each $n = 2, 8, 100$,</span>
<span id="cb107-122"><a href="#cb107-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-123"><a href="#cb107-123" aria-hidden="true" tabindex="-1"></a>i. Draw $n$ values $x_1, x_2, \dots, x_n$ using <span class="in">`rchisq(n, df = 1)`</span>.</span>
<span id="cb107-124"><a href="#cb107-124" aria-hidden="true" tabindex="-1"></a>ii. Compute the mean of the $n$ values, which is $\overline{x}_n$.</span>
<span id="cb107-125"><a href="#cb107-125" aria-hidden="true" tabindex="-1"></a>iii. Repeat i. and ii. 1000 times to obtain 1000 $\overline{x}_n$s.</span>
<span id="cb107-126"><a href="#cb107-126" aria-hidden="true" tabindex="-1"></a>iv. Plot the histogram of these 1000 $\overline{x}_n$s.</span>
<span id="cb107-127"><a href="#cb107-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-128"><a href="#cb107-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-131"><a href="#cb107-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-132"><a href="#cb107-132" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-133"><a href="#cb107-133" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">006220587</span>)</span>
<span id="cb107-134"><a href="#cb107-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-135"><a href="#cb107-135" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb107-136"><a href="#cb107-136" aria-hidden="true" tabindex="-1"></a>chi2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb107-137"><a href="#cb107-137" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mean</span>(<span class="fu">rchisq</span>(<span class="dv">2</span>, <span class="at">df =</span> <span class="dv">1</span>)))</span>
<span id="cb107-138"><a href="#cb107-138" aria-hidden="true" tabindex="-1"></a>chi2 <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span>
<span id="cb107-139"><a href="#cb107-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-140"><a href="#cb107-140" aria-hidden="true" tabindex="-1"></a><span class="co">#8</span></span>
<span id="cb107-141"><a href="#cb107-141" aria-hidden="true" tabindex="-1"></a>chi8 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb107-142"><a href="#cb107-142" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mean</span>(<span class="fu">rchisq</span>(<span class="dv">8</span>, <span class="at">df =</span> <span class="dv">1</span>)))</span>
<span id="cb107-143"><a href="#cb107-143" aria-hidden="true" tabindex="-1"></a>chi8 <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span>
<span id="cb107-144"><a href="#cb107-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-145"><a href="#cb107-145" aria-hidden="true" tabindex="-1"></a><span class="co">#100</span></span>
<span id="cb107-146"><a href="#cb107-146" aria-hidden="true" tabindex="-1"></a>chi100 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb107-147"><a href="#cb107-147" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mean</span>(<span class="fu">rchisq</span>(<span class="dv">100</span>, <span class="at">df =</span> <span class="dv">1</span>)))</span>
<span id="cb107-148"><a href="#cb107-148" aria-hidden="true" tabindex="-1"></a>chi100 <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span>
<span id="cb107-149"><a href="#cb107-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-150"><a href="#cb107-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-151"><a href="#cb107-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-152"><a href="#cb107-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-153"><a href="#cb107-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-154"><a href="#cb107-154" aria-hidden="true" tabindex="-1"></a><span class="fu"># Machine Learning</span></span>
<span id="cb107-155"><a href="#cb107-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-156"><a href="#cb107-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Regression</span></span>
<span id="cb107-157"><a href="#cb107-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-158"><a href="#cb107-158" aria-hidden="true" tabindex="-1"></a>A pharmaceutical firm would like to obtain information on the relationship between the dose level and potency of a drug product. To do this, each of 15 test tubes is inoculated with a virus culture and incubated for 5 days at 30°C. Three test tubes are randomly assigned to each of the five different dose levels to be investigated (2, 4, 8, 16, and 32 mg). Each tube is injected with only one dose level, and the response of interest is obtained.</span>
<span id="cb107-159"><a href="#cb107-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-160"><a href="#cb107-160" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Import <span class="in">`dose.csv`</span> in the <span class="in">`/data`</span> folder into your R session. The data set is not tidy. Use <span class="in">`pivot_longer()`</span> to make it tidy as the shown tibble below. Call the tidy data set <span class="in">`dose_tidy`</span>.</span>
<span id="cb107-161"><a href="#cb107-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-164"><a href="#cb107-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-165"><a href="#cb107-165" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-166"><a href="#cb107-166" aria-hidden="true" tabindex="-1"></a>dose <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./data/dose.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-167"><a href="#cb107-167" aria-hidden="true" tabindex="-1"></a>dose</span>
<span id="cb107-168"><a href="#cb107-168" aria-hidden="true" tabindex="-1"></a>dose_tidy <span class="ot">&lt;-</span> dose <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> tube_1<span class="sc">:</span>tube_3, </span>
<span id="cb107-169"><a href="#cb107-169" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">names_to =</span> <span class="st">"tube"</span>, </span>
<span id="cb107-170"><a href="#cb107-170" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">values_to =</span> <span class="st">"response"</span></span>
<span id="cb107-171"><a href="#cb107-171" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb107-172"><a href="#cb107-172" aria-hidden="true" tabindex="-1"></a>dose_tidy</span>
<span id="cb107-173"><a href="#cb107-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-174"><a href="#cb107-174" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 15 × 3</span></span>
<span id="cb107-175"><a href="#cb107-175" aria-hidden="true" tabindex="-1"></a><span class="do">##    dose_level tube  response</span></span>
<span id="cb107-176"><a href="#cb107-176" aria-hidden="true" tabindex="-1"></a><span class="do">##         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span id="cb107-177"><a href="#cb107-177" aria-hidden="true" tabindex="-1"></a><span class="do">##  1          2 tube1        5</span></span>
<span id="cb107-178"><a href="#cb107-178" aria-hidden="true" tabindex="-1"></a><span class="do">##  2          2 tube2        7</span></span>
<span id="cb107-179"><a href="#cb107-179" aria-hidden="true" tabindex="-1"></a><span class="do">##  3          2 tube3        3</span></span>
<span id="cb107-180"><a href="#cb107-180" aria-hidden="true" tabindex="-1"></a><span class="do">##  4          4 tube1       10</span></span>
<span id="cb107-181"><a href="#cb107-181" aria-hidden="true" tabindex="-1"></a><span class="do">##  5          4 tube2       12</span></span>
<span id="cb107-182"><a href="#cb107-182" aria-hidden="true" tabindex="-1"></a><span class="do">##  6          4 tube3       14</span></span>
<span id="cb107-183"><a href="#cb107-183" aria-hidden="true" tabindex="-1"></a><span class="do">##  7          8 tube1       15</span></span>
<span id="cb107-184"><a href="#cb107-184" aria-hidden="true" tabindex="-1"></a><span class="do">##  8          8 tube2       17</span></span>
<span id="cb107-185"><a href="#cb107-185" aria-hidden="true" tabindex="-1"></a><span class="do">##  9          8 tube3       18</span></span>
<span id="cb107-186"><a href="#cb107-186" aria-hidden="true" tabindex="-1"></a><span class="do">## 10         16 tube1       20</span></span>
<span id="cb107-187"><a href="#cb107-187" aria-hidden="true" tabindex="-1"></a><span class="do">## 11         16 tube2       21</span></span>
<span id="cb107-188"><a href="#cb107-188" aria-hidden="true" tabindex="-1"></a><span class="do">## 12         16 tube3       19</span></span>
<span id="cb107-189"><a href="#cb107-189" aria-hidden="true" tabindex="-1"></a><span class="do">## 13         32 tube1       23</span></span>
<span id="cb107-190"><a href="#cb107-190" aria-hidden="true" tabindex="-1"></a><span class="do">## 14         32 tube2       24</span></span>
<span id="cb107-191"><a href="#cb107-191" aria-hidden="true" tabindex="-1"></a><span class="do">## 15         32 tube3       29</span></span>
<span id="cb107-192"><a href="#cb107-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-193"><a href="#cb107-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-194"><a href="#cb107-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-195"><a href="#cb107-195" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Fit a simple linear regression with the predictor $\texttt{dose level}$ for <span class="in">`response`</span>. Print the fitted result. </span>
<span id="cb107-196"><a href="#cb107-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-199"><a href="#cb107-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-200"><a href="#cb107-200" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-201"><a href="#cb107-201" aria-hidden="true" tabindex="-1"></a>doseLin1 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb107-202"><a href="#cb107-202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-203"><a href="#cb107-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(response <span class="sc">~</span> dose_level, <span class="at">data =</span> dose_tidy)</span>
<span id="cb107-204"><a href="#cb107-204" aria-hidden="true" tabindex="-1"></a>doseLin1</span>
<span id="cb107-205"><a href="#cb107-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-206"><a href="#cb107-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-207"><a href="#cb107-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-208"><a href="#cb107-208" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>With (2), plot the data with a $95\%$ confidence interval for the mean response.</span>
<span id="cb107-209"><a href="#cb107-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-212"><a href="#cb107-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-213"><a href="#cb107-213" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-214"><a href="#cb107-214" aria-hidden="true" tabindex="-1"></a>confLin <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">predict</span>(doseLin1<span class="sc">$</span>fit,</span>
<span id="cb107-215"><a href="#cb107-215" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>, </span>
<span id="cb107-216"><a href="#cb107-216" aria-hidden="true" tabindex="-1"></a>        <span class="at">level =</span> <span class="fl">0.95</span>))</span>
<span id="cb107-217"><a href="#cb107-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-218"><a href="#cb107-218" aria-hidden="true" tabindex="-1"></a>doseLin1<span class="sc">$</span>fit <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose_level, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb107-219"><a href="#cb107-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb107-220"><a href="#cb107-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb107-221"><a href="#cb107-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>lwr),</span>
<span id="cb107-222"><a href="#cb107-222" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb107-223"><a href="#cb107-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>upr),</span>
<span id="cb107-224"><a href="#cb107-224" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>)</span>
<span id="cb107-225"><a href="#cb107-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-226"><a href="#cb107-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-227"><a href="#cb107-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-228"><a href="#cb107-228" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Fit a simple linear regression model with the predictor $\texttt{ln(dose level)}$ for <span class="in">`response`</span>, where $\ln = \log_e$. Print the fitted result.</span>
<span id="cb107-229"><a href="#cb107-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-232"><a href="#cb107-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-233"><a href="#cb107-233" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-234"><a href="#cb107-234" aria-hidden="true" tabindex="-1"></a>dose_tidy <span class="ot">&lt;-</span> dose_tidy <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ln_dose_level =</span> <span class="fu">log</span>(dose_level))</span>
<span id="cb107-235"><a href="#cb107-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-236"><a href="#cb107-236" aria-hidden="true" tabindex="-1"></a>doseLin2 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span></span>
<span id="cb107-237"><a href="#cb107-237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb107-238"><a href="#cb107-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(response <span class="sc">~</span> ln_dose_level, <span class="at">data =</span> dose_tidy)</span>
<span id="cb107-239"><a href="#cb107-239" aria-hidden="true" tabindex="-1"></a>doseLin2</span>
<span id="cb107-240"><a href="#cb107-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-241"><a href="#cb107-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-242"><a href="#cb107-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-243"><a href="#cb107-243" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>With (4), plot the data $(\ln(\text{dose level})_i, y_i)$ with a $95\%$ confidence interval for the mean response.</span>
<span id="cb107-244"><a href="#cb107-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-247"><a href="#cb107-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-248"><a href="#cb107-248" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb107-249"><a href="#cb107-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-250"><a href="#cb107-250" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-251"><a href="#cb107-251" aria-hidden="true" tabindex="-1"></a>confLin <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">predict</span>(doseLin2<span class="sc">$</span>fit,</span>
<span id="cb107-252"><a href="#cb107-252" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>, </span>
<span id="cb107-253"><a href="#cb107-253" aria-hidden="true" tabindex="-1"></a>        <span class="at">level =</span> <span class="fl">0.95</span>))</span>
<span id="cb107-254"><a href="#cb107-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-255"><a href="#cb107-255" aria-hidden="true" tabindex="-1"></a>doseLin2<span class="sc">$</span>fit <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ln_dose_level, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb107-256"><a href="#cb107-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb107-257"><a href="#cb107-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb107-258"><a href="#cb107-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ln_dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>lwr),</span>
<span id="cb107-259"><a href="#cb107-259" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb107-260"><a href="#cb107-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ln_dose_level, <span class="at">y =</span> confLin<span class="sc">$</span>upr),</span>
<span id="cb107-261"><a href="#cb107-261" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'red'</span>)</span>
<span id="cb107-262"><a href="#cb107-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-263"><a href="#cb107-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-264"><a href="#cb107-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-265"><a href="#cb107-265" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Draw residual plots of Model in (2) and (4). According to the plots, which model you think is better?</span>
<span id="cb107-266"><a href="#cb107-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-269"><a href="#cb107-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-270"><a href="#cb107-270" aria-hidden="true" tabindex="-1"></a><span class="do">## code</span></span>
<span id="cb107-271"><a href="#cb107-271" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(doseLin1<span class="sc">$</span>fit, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb107-272"><a href="#cb107-272" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(doseLin2<span class="sc">$</span>fit, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb107-273"><a href="#cb107-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-274"><a href="#cb107-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-275"><a href="#cb107-275" aria-hidden="true" tabindex="-1"></a>There seems to be less of a pattern in the regression plot using ln_dose_level (the second one), whereas the first one seems to be overfitted, so the model used in the second regression plot is the better model.</span>
<span id="cb107-276"><a href="#cb107-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-277"><a href="#cb107-277" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Import <span class="in">`dose_tidy.csv`</span> and redo (2) using **Python**. Show the slope and intercept.</span>
<span id="cb107-278"><a href="#cb107-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-281"><a href="#cb107-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb107-282"><a href="#cb107-282" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-283"><a href="#cb107-283" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb107-284"><a href="#cb107-284" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb107-285"><a href="#cb107-285" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb107-286"><a href="#cb107-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-287"><a href="#cb107-287" aria-hidden="true" tabindex="-1"></a>dose_tidy <span class="op">=</span> pd.read_csv(<span class="st">'./data/dose_tidy.csv'</span>)</span>
<span id="cb107-288"><a href="#cb107-288" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array(dose_tidy[<span class="st">'dose_level'</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb107-289"><a href="#cb107-289" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(dose_tidy[<span class="st">'response'</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb107-290"><a href="#cb107-290" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> LinearRegression().fit(x, y)</span>
<span id="cb107-291"><a href="#cb107-291" aria-hidden="true" tabindex="-1"></a>reg.coef_</span>
<span id="cb107-292"><a href="#cb107-292" aria-hidden="true" tabindex="-1"></a>reg.intercept_</span>
<span id="cb107-293"><a href="#cb107-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-294"><a href="#cb107-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-295"><a href="#cb107-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-296"><a href="#cb107-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-297"><a href="#cb107-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-298"><a href="#cb107-298" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Use **Python** to predict the response value when the dose level is 10, 20, and 30.</span>
<span id="cb107-299"><a href="#cb107-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-302"><a href="#cb107-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb107-303"><a href="#cb107-303" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-304"><a href="#cb107-304" aria-hidden="true" tabindex="-1"></a>new_input <span class="op">=</span> np.arange(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb107-305"><a href="#cb107-305" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> reg.predict(new_input)</span>
<span id="cb107-306"><a href="#cb107-306" aria-hidden="true" tabindex="-1"></a>pred</span>
<span id="cb107-307"><a href="#cb107-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-308"><a href="#cb107-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-309"><a href="#cb107-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-310"><a href="#cb107-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-311"><a href="#cb107-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic Regression</span></span>
<span id="cb107-312"><a href="#cb107-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-313"><a href="#cb107-313" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Import <span class="in">`body.csv`</span> in the <span class="in">`/data`</span> folder. Split the data into a training set and a test set. Set the random seed at your student ID number. Use 80:20 rule.</span>
<span id="cb107-314"><a href="#cb107-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-317"><a href="#cb107-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-318"><a href="#cb107-318" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-319"><a href="#cb107-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">006220587</span>)</span>
<span id="cb107-320"><a href="#cb107-320" aria-hidden="true" tabindex="-1"></a>  body <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./data/body.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-321"><a href="#cb107-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-322"><a href="#cb107-322" aria-hidden="true" tabindex="-1"></a>df_split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(</span>
<span id="cb107-323"><a href="#cb107-323" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> body, </span>
<span id="cb107-324"><a href="#cb107-324" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb107-325"><a href="#cb107-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-326"><a href="#cb107-326" aria-hidden="true" tabindex="-1"></a>df_trn <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(df_split)</span>
<span id="cb107-327"><a href="#cb107-327" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_trn)</span>
<span id="cb107-328"><a href="#cb107-328" aria-hidden="true" tabindex="-1"></a>df_tst <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(df_split)</span>
<span id="cb107-329"><a href="#cb107-329" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_tst)</span>
<span id="cb107-330"><a href="#cb107-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-331"><a href="#cb107-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-332"><a href="#cb107-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-333"><a href="#cb107-333" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Fit a logistic regression with the predictor <span class="in">`HEIGHT`</span> using the training sample data. Find the probability that the subject is male given <span class="in">`HEIGHT = 165`</span>.</span>
<span id="cb107-334"><a href="#cb107-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-337"><a href="#cb107-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-338"><a href="#cb107-338" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-339"><a href="#cb107-339" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb107-340"><a href="#cb107-340" aria-hidden="true" tabindex="-1"></a>logis_mdl_ht <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb107-341"><a href="#cb107-341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"glm"</span>) </span>
<span id="cb107-342"><a href="#cb107-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-343"><a href="#cb107-343" aria-hidden="true" tabindex="-1"></a>df_trn<span class="sc">$</span>GENDER <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_trn<span class="sc">$</span>GENDER)</span>
<span id="cb107-344"><a href="#cb107-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-345"><a href="#cb107-345" aria-hidden="true" tabindex="-1"></a>logis_fit_ht <span class="ot">&lt;-</span> logis_mdl_ht <span class="sc">|&gt;</span> </span>
<span id="cb107-346"><a href="#cb107-346" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(GENDER <span class="sc">~</span> HEIGHT, </span>
<span id="cb107-347"><a href="#cb107-347" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df_trn, </span>
<span id="cb107-348"><a href="#cb107-348" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb107-349"><a href="#cb107-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-350"><a href="#cb107-350" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logis_fit_ht<span class="sc">$</span>fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">HEIGHT =</span> <span class="dv">165</span>), <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb107-351"><a href="#cb107-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-352"><a href="#cb107-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-353"><a href="#cb107-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-354"><a href="#cb107-354" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Fit a logistic regression with the predictor <span class="in">`BMI`</span> using the training sample data. Find the probability that the subject is male given <span class="in">`BMI = 25`</span>.</span>
<span id="cb107-355"><a href="#cb107-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-358"><a href="#cb107-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-359"><a href="#cb107-359" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-360"><a href="#cb107-360" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb107-361"><a href="#cb107-361" aria-hidden="true" tabindex="-1"></a>logis_mdl_bmi <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb107-362"><a href="#cb107-362" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"glm"</span>) </span>
<span id="cb107-363"><a href="#cb107-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-364"><a href="#cb107-364" aria-hidden="true" tabindex="-1"></a>logis_fit_bmi <span class="ot">&lt;-</span> logis_mdl_bmi <span class="sc">|&gt;</span> </span>
<span id="cb107-365"><a href="#cb107-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(GENDER <span class="sc">~</span> BMI, </span>
<span id="cb107-366"><a href="#cb107-366" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df_trn, </span>
<span id="cb107-367"><a href="#cb107-367" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb107-368"><a href="#cb107-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-369"><a href="#cb107-369" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logis_fit_bmi<span class="sc">$</span>fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">BMI =</span> <span class="dv">165</span>), <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb107-370"><a href="#cb107-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-371"><a href="#cb107-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-372"><a href="#cb107-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-373"><a href="#cb107-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-374"><a href="#cb107-374" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Do the classification on the test set for the model (2) and (3), and compute the test accuracy rate. Which model gives us higher accuracy rate?</span>
<span id="cb107-375"><a href="#cb107-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-378"><a href="#cb107-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-379"><a href="#cb107-379" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-380"><a href="#cb107-380" aria-hidden="true" tabindex="-1"></a><span class="co"># height</span></span>
<span id="cb107-381"><a href="#cb107-381" aria-hidden="true" tabindex="-1"></a>pred_ht <span class="ot">&lt;-</span> </span>
<span id="cb107-382"><a href="#cb107-382" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(logis_fit_ht, df_tst))</span>
<span id="cb107-383"><a href="#cb107-383" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb107-384"><a href="#cb107-384" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pred_ht <span class="sc">==</span> df_tst<span class="sc">$</span>GENDER)</span>
<span id="cb107-385"><a href="#cb107-385" aria-hidden="true" tabindex="-1"></a><span class="co"># bmi</span></span>
<span id="cb107-386"><a href="#cb107-386" aria-hidden="true" tabindex="-1"></a>pred_bmi <span class="ot">&lt;-</span> </span>
<span id="cb107-387"><a href="#cb107-387" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(logis_fit_bmi, df_tst))</span>
<span id="cb107-388"><a href="#cb107-388" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb107-389"><a href="#cb107-389" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pred_bmi <span class="sc">==</span> df_tst<span class="sc">$</span>BMI)</span>
<span id="cb107-390"><a href="#cb107-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-391"><a href="#cb107-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-392"><a href="#cb107-392" aria-hidden="true" tabindex="-1"></a>The better test accuracy rate is from the regression fitted to HEIGHT. It is around 85% while the test accuracy rate is 0% for BMI</span>
<span id="cb107-393"><a href="#cb107-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-394"><a href="#cb107-394" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Use **Python** to split the <span class="in">`body`</span> data into a training set and a test set.</span>
<span id="cb107-395"><a href="#cb107-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-398"><a href="#cb107-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb107-399"><a href="#cb107-399" aria-hidden="true" tabindex="-1"></a><span class="co">## code</span></span>
<span id="cb107-400"><a href="#cb107-400" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb107-401"><a href="#cb107-401" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb107-402"><a href="#cb107-402" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb107-403"><a href="#cb107-403" aria-hidden="true" tabindex="-1"></a>body <span class="op">=</span> pd.read_csv(<span class="st">'./data/body.csv'</span>)</span>
<span id="cb107-404"><a href="#cb107-404" aria-hidden="true" tabindex="-1"></a>body[<span class="st">'GENDER'</span>] <span class="op">=</span> body[<span class="st">'GENDER'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb107-405"><a href="#cb107-405" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> body[[<span class="st">'HEIGHT'</span>]]</span>
<span id="cb107-406"><a href="#cb107-406" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> body[[<span class="st">'GENDER'</span>]]</span>
<span id="cb107-407"><a href="#cb107-407" aria-hidden="true" tabindex="-1"></a>X</span>
<span id="cb107-408"><a href="#cb107-408" aria-hidden="true" tabindex="-1"></a>Y</span>
<span id="cb107-409"><a href="#cb107-409" aria-hidden="true" tabindex="-1"></a>X_trn, X_tst, y_trn, y_tst <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">6220587</span>)</span>
<span id="cb107-410"><a href="#cb107-410" aria-hidden="true" tabindex="-1"></a>X_trn</span>
<span id="cb107-411"><a href="#cb107-411" aria-hidden="true" tabindex="-1"></a>y_trn</span>
<span id="cb107-412"><a href="#cb107-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-413"><a href="#cb107-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-414"><a href="#cb107-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-415"><a href="#cb107-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-416"><a href="#cb107-416" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Use **Python** to fit a logistic regression with the predictor <span class="in">`BMI`</span> using the training sample data. Find the probability that the subject is male given <span class="in">`BMI = 25`</span>.</span>
<span id="cb107-417"><a href="#cb107-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-420"><a href="#cb107-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb107-421"><a href="#cb107-421" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-422"><a href="#cb107-422" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb107-423"><a href="#cb107-423" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array(X_trn[<span class="st">'HEIGHT'</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="co">## 2d array with one column</span></span>
<span id="cb107-424"><a href="#cb107-424" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb107-425"><a href="#cb107-425" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(y_trn[<span class="st">'GENDER'</span>]) <span class="co">## 1d array</span></span>
<span id="cb107-426"><a href="#cb107-426" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb107-427"><a href="#cb107-427" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LogisticRegression().fit(x, y)</span>
<span id="cb107-428"><a href="#cb107-428" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> pd.DataFrame({<span class="st">'BMI'</span>: [<span class="dv">25</span>]})</span>
<span id="cb107-429"><a href="#cb107-429" aria-hidden="true" tabindex="-1"></a>prob_male <span class="op">=</span> clf.predict(new_data)</span>
<span id="cb107-430"><a href="#cb107-430" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prob_male)</span>
<span id="cb107-431"><a href="#cb107-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-432"><a href="#cb107-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-433"><a href="#cb107-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-434"><a href="#cb107-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-435"><a href="#cb107-435" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Use **Python** to do the classification on the test set. Compute the test accuracy rate.</span>
<span id="cb107-436"><a href="#cb107-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-439"><a href="#cb107-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb107-440"><a href="#cb107-440" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-441"><a href="#cb107-441" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> clf.predict(X_tst)</span>
<span id="cb107-442"><a href="#cb107-442" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb107-443"><a href="#cb107-443" aria-hidden="true" tabindex="-1"></a>confusion_matrix(y_tst, y_pred)</span>
<span id="cb107-444"><a href="#cb107-444" aria-hidden="true" tabindex="-1"></a>y_tst_arr <span class="op">=</span> np.array(y_tst[<span class="st">'GENDER'</span>])</span>
<span id="cb107-445"><a href="#cb107-445" aria-hidden="true" tabindex="-1"></a><span class="co">#y_tst = y_tst[:, 1]</span></span>
<span id="cb107-446"><a href="#cb107-446" aria-hidden="true" tabindex="-1"></a>y_tst_arr</span>
<span id="cb107-447"><a href="#cb107-447" aria-hidden="true" tabindex="-1"></a>y_pred</span>
<span id="cb107-448"><a href="#cb107-448" aria-hidden="true" tabindex="-1"></a>np.mean(y_tst_arr <span class="op">==</span> y_pred)</span>
<span id="cb107-449"><a href="#cb107-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-450"><a href="#cb107-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-451"><a href="#cb107-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-452"><a href="#cb107-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-453"><a href="#cb107-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## K-Nearest Neighbors (KNN)</span></span>
<span id="cb107-454"><a href="#cb107-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-455"><a href="#cb107-455" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Fit the KNN with $K=1$ and $10$ using <span class="in">`BMI`</span> on the training data and do the classification on the same test set used in logistic regression. Obtain the confusion matrix for each $K$. Which $K$ performs better? Why?</span>
<span id="cb107-456"><a href="#cb107-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-459"><a href="#cb107-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-460"><a href="#cb107-460" aria-hidden="true" tabindex="-1"></a><span class="co"># code</span></span>
<span id="cb107-461"><a href="#cb107-461" aria-hidden="true" tabindex="-1"></a>(knn_recipe <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(GENDER <span class="sc">~</span> HEIGHT, <span class="at">data =</span> df_trn) <span class="sc">|&gt;</span> </span>
<span id="cb107-462"><a href="#cb107-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>()))</span>
<span id="cb107-463"><a href="#cb107-463" aria-hidden="true" tabindex="-1"></a>(knn_mdl1 <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">nearest_neighbor</span>(<span class="at">neighbors =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-464"><a href="#cb107-464" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-465"><a href="#cb107-465" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"kknn"</span>))</span>
<span id="cb107-466"><a href="#cb107-466" aria-hidden="true" tabindex="-1"></a>(knn_mdl10 <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">nearest_neighbor</span>(<span class="at">neighbors =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-467"><a href="#cb107-467" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-468"><a href="#cb107-468" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_engine</span>(<span class="st">"kknn"</span>))</span>
<span id="cb107-469"><a href="#cb107-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-470"><a href="#cb107-470" aria-hidden="true" tabindex="-1"></a>(knn_fit1 <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb107-471"><a href="#cb107-471" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(knn_recipe) <span class="sc">|&gt;</span> </span>
<span id="cb107-472"><a href="#cb107-472" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(knn_mdl1) <span class="sc">|&gt;</span> </span>
<span id="cb107-473"><a href="#cb107-473" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(<span class="at">data =</span> df_trn))</span>
<span id="cb107-474"><a href="#cb107-474" aria-hidden="true" tabindex="-1"></a>(knn_fit10 <span class="ot">&lt;-</span> workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb107-475"><a href="#cb107-475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(knn_recipe) <span class="sc">|&gt;</span> </span>
<span id="cb107-476"><a href="#cb107-476" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(knn_mdl10) <span class="sc">|&gt;</span> </span>
<span id="cb107-477"><a href="#cb107-477" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(<span class="at">data =</span> df_trn))</span>
<span id="cb107-478"><a href="#cb107-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-479"><a href="#cb107-479" aria-hidden="true" tabindex="-1"></a>knn_pred1 <span class="ot">&lt;-</span> </span>
<span id="cb107-480"><a href="#cb107-480" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(knn_fit1, df_tst))</span>
<span id="cb107-481"><a href="#cb107-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-482"><a href="#cb107-482" aria-hidden="true" tabindex="-1"></a><span class="do">## Confusion matrix</span></span>
<span id="cb107-483"><a href="#cb107-483" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(knn_pred1, df_tst<span class="sc">$</span>GENDER)</span>
<span id="cb107-484"><a href="#cb107-484" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb107-485"><a href="#cb107-485" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(knn_pred1 <span class="sc">==</span> df_tst<span class="sc">$</span>GENDER)</span>
<span id="cb107-486"><a href="#cb107-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-487"><a href="#cb107-487" aria-hidden="true" tabindex="-1"></a>knn_pred10 <span class="ot">&lt;-</span> </span>
<span id="cb107-488"><a href="#cb107-488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="fu">predict</span>(knn_fit10, df_tst))</span>
<span id="cb107-489"><a href="#cb107-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-490"><a href="#cb107-490" aria-hidden="true" tabindex="-1"></a><span class="do">## Confusion matrix</span></span>
<span id="cb107-491"><a href="#cb107-491" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(knn_pred10, df_tst<span class="sc">$</span>GENDER)</span>
<span id="cb107-492"><a href="#cb107-492" aria-hidden="true" tabindex="-1"></a><span class="do">## Test accuracy rate</span></span>
<span id="cb107-493"><a href="#cb107-493" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(knn_pred10 <span class="sc">==</span> df_tst<span class="sc">$</span>GENDER)</span>
<span id="cb107-494"><a href="#cb107-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-495"><a href="#cb107-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-496"><a href="#cb107-496" aria-hidden="true" tabindex="-1"></a>The test accuracy rate is better for k=1 than k=10, meaning that k=1 performs better because a higher percentage of correct predictions were made with k=1</span>
<span id="cb107-497"><a href="#cb107-497" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>